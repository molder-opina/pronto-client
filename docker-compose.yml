networks:
  pronto:
    name: '${NETWORK_NAME:-pronto_net}'

services:
  client:
    build:
      context: ./src
      dockerfile: pronto-client/Dockerfile
    image: '${CLIENT_IMAGE_REPO:-pronto-client}:${CLIENT_IMAGE_TAG:-latest}'
    container_name: '${APP_NAME:-pronto}-client'
    ports:
      - '${CLIENT_APP_HOST_PORT:-6080}:5000'
    networks: [pronto]
    restart: unless-stopped
    environment:
      DEBUG_MODE: '${DEBUG_MODE:-true}'
      FLASK_DEBUG: '${FLASK_DEBUG:-true}'
      LOG_LEVEL: '${LOG_LEVEL:-DEBUG}'
      LOAD_SEED_DATA: '${LOAD_SEED_DATA:-false}'
      USE_LOCAL_POSTGRES: '${USE_LOCAL_POSTGRES:-true}'
      POSTGRES_HOST: '${POSTGRES_HOST:-postgres}'
      POSTGRES_PORT: '${POSTGRES_PORT:-5432}'
      POSTGRES_USER: '${POSTGRES_USER:-pronto}'
      POSTGRES_PASSWORD: '${POSTGRES_PASSWORD:-pronto123}'
      POSTGRES_DB: '${POSTGRES_DB:-pronto}'
      REDIS_HOST: '${REDIS_HOST:-redis}'
      REDIS_PORT: '${REDIS_PORT:-6379}'
      JWT_ACCESS_TOKEN_EXPIRES_HOURS: '${JWT_ACCESS_TOKEN_EXPIRES_HOURS:-24}'
      JWT_REFRESH_TOKEN_EXPIRES_DAYS: '${JWT_REFRESH_TOKEN_EXPIRES_DAYS:-7}'
      PRONTO_STATIC_CONTAINER_HOST: '${PRONTO_STATIC_CONTAINER_HOST:-http://localhost:9088}'
      SECRET_KEY: '${SECRET_KEY:-lhlJHWqUOdYUveqkzz6nClgGpzheVFuxd5bRWJBNVEA}'
      HANDOFF_PEPPER: '${HANDOFF_PEPPER:-YW5vdGhlci1zZWN1cmUtcGVwcGVyLWZvci1oYW5kb2ZmLXRva2Vu}'
      PASSWORD_HASH_SALT: '${PASSWORD_HASH_SALT:-AUILydszwFkPNU0s6NlNFKvDB0DcA0dlp3Kan99q2ZY}'
      CUSTOMER_DATA_KEY: '${CUSTOMER_DATA_KEY:-c3VwcGxlLW1vcmUtZGF0YS1lbmNyeXB0aW9uLWtleS1mb3ItY3VzdG9tZXI}'
      RESTAURANT_NAME: '${RESTAURANT_NAME:-Cafeter√≠a de Prueba}'
      TAX_RATE: '${TAX_RATE:-0.16}'
      STATIC_ASSETS_PATH: '${STATIC_ASSETS_PATH:-/assets}'
      STATIC_ASSETS_ROOT: '${STATIC_ASSETS_ROOT:-/var/www/pronto-static/assets}'
      NGINX_HOST: '${NGINX_HOST:-static}'
      NGINX_PORT: '${NGINX_PORT:-80}'
      STRIPE_API_KEY: '${STRIPE_API_KEY:-}'
      CASHIER_DEFAULT_PAYMENT_METHOD: '${CASHIER_DEFAULT_PAYMENT_METHOD:-cash}'
      CASHIER_RECEIPT_PRINTER_ENABLED: '${CASHIER_RECEIPT_PRINTER_ENABLED:-false}'
      CASHIER_AUTO_REFRESH_SECONDS: '${CASHIER_AUTO_REFRESH_SECONDS:-30}'
      CASHIER_SHOW_TIP_SUGGESTIONS: '${CASHIER_SHOW_TIP_SUGGESTIONS:-true}'
      CASHIER_TIP_SUGGESTIONS_PERCENTAGES: '${CASHIER_TIP_SUGGESTIONS_PERCENTAGES:-10,15,20}'
      CORS_ALLOWED_ORIGINS: '${CORS_ALLOWED_ORIGINS:-}'
      NUM_PROXIES: '${NUM_PROXIES:-0}'
      ALLOWED_HOSTS: '${ALLOWED_HOSTS:-localhost:6080,127.0.0.1:6080}'
      DEBUG_AUTO_TABLE: '${DEBUG_AUTO_TABLE:-true}'
    command:
      [
        'gunicorn',
        '-b',
        '0.0.0.0:5000',
        '--timeout',
        '120',
        '--workers',
        '2',
        '--threads',
        '4',
        'wsgi:application',
      ]
